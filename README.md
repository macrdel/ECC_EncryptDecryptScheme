# Программная реализация криптоалгоритма на основе эллиптических кривых

### Требования

*	возможность шифровать/расшифровывать короткие сообщения на случайных (или извлекаемых из выбираемых файлов) асимметрических ключах выбираемой пользователем длины;
*	возможность сохранения случайной пары ключей в двух файлах с задаваемыми пользователем именами (закрытый ключ должен при этом шифроваться на ключе, выводимом из специальной парольной фразы);
*	возможность определять при расшифровании закрытого ключа факт ввода неверной парольной фразы (например, путем добавления к ключу перед его шифрованием сигнатуры – специальной строки символов – с проверкой ее наличия в расшифрованном ключе и удалением из него в случае успешной проверки).

### Схема

Генерация ключей -> Шифрование -> Расшифрование

### Генерация ключей

<ol>
<li> На основе выбранной пользователем длины ключа выбирается соответствующая кривая
<li> Выбирается случайное число privKey (из диапазона [1,N-1]) – это <b>закрытый ключ</b>
<li> Вычисляется <b>открытый ключ</b> pubKey = privKey $\cdot$ G (результат скалярного умножения)
<li> Выполняется шифрование  privKey:
<pre><ul>
<li> к закрытому ключу добавляется специальная сигнатура для проверки правильности введенной парольной фразы
<li> на основе введенной пользователем парольной фразы (и сгенерированной примеси) и алгоритма SHA-256 строится симметричный ключ шифрования
<li> на основе симметричного алгоритма AES на сгенерированном в предыдущем пункте ключе строится шифратор, который шифрует закрытый ключ со спец. сигнатурой
<li> в начало зашифрованного файла добавляется примесь, затем шифротекст
</ul></pre>
<li> Открытый ключ pubKey записывается в соответствующий файл
</ol>

### Шифрование

<ol>
<li> Считывается открытый ключ Qa и в зависимости от его размера выбирается кривая crv
<li> Генерируется случайное число r (из диапазона $[1,N-1]$)
<li> Вычисляется точка rG = r $\cdot$ G (результат скалярного умножения)
<li> Вычисляется точка S = r $\cdot$ Qa (результат скалярного умножения),   S=(Sx, Sy)
<li> Сообщение msg представляется в виде числа P
<li> Вычисляется шифротекст Cm = (Sx + P) $\mod N$
<li> Шифротексты Cm и rG записываются в файл
</ol>

### Расшифрование

<ol>
<li> Выполняется расшифрование закрытого ключа:
<pre><ul>
<li> из начала зашифрованного файла считывается примесь
<li> на основе введенной парольной фразы (она может быть правильной или нет), примеси и алгоритма SHA-256 восстанавливается построенный на этапе генерации ключ
<li> на основе симметричного алгоритма AES на восстановленном в предыдущем пункте ключе строится дешифратор, который расшифровывает закрытый ключ со спец. сигнатурой
</ul></pre>
<li> Проверяется сигнатура: в случае неверной сигнатуры (неправильная введенная парольная фраза) выводится сообщение об ошибке и форма закрывается
<li> Считываются шифротексты Cm и rG
<li> Выбирается кривая crv (размер ключа можно сохранить в зашифрованном виде вместе с сигнатурой и закрытым ключом)
<li> Поскольку privKey $\cdot$ rG = privKey $\cdot$ r $\cdot$ G=r $\cdot$ pubKey= r $\cdot$ Qa, то можно восстановить S = privKey $\cdot$ rG  (результат скалярного умножения),   S=(Sx, Sy)
<li> Восстанавливается P = (Cm-Sx) $\mod N$
<li> Число P преобразуется обратно в сообщение msg
</ol>
</ol>

Подробнее в [пояснительной записке](...blob/master/Пояснительная%20записка.pdf)

<hr>

# Implementation of cryptoalgorithm based on elliptic curves

### Scheme

Key generation -> Encryption -> Decryption

### Key generation

### Encryption

### Decryption

More details in [document](...blob/master/Пояснительная%20записка.pdf)
